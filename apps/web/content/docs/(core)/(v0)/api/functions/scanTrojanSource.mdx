[**@promptshield/core**](../index.md)

***

[@promptshield/core](../index.md) / scanTrojanSource

# Function: scanTrojanSource()

> **scanTrojanSource**(`text`, `options?`, `context?`): [`ThreatReport`](../interfaces/ThreatReport.md)[]

Defined in: [trojan.ts:50](https://github.com/promptshield-io/promptshield/blob/main/packages/core/src/trojan.ts#L50)

Trojan Source detector.

Detects unsafe usage of Unicode Bidirectional (BIDI) control characters
that may cause visual ordering to differ from logical ordering.

Detection model:
 - Tracks BIDI PUSH → POP spans per line
 - Emits ONE threat per detected sequence
 - Reports CRITICAL when a sequence is unterminated
 - Ignores unmatched POP characters (low-signal)

Span semantics:
 - offendingText = PUSH + hidden region (+ optional POP)
 - decodedPayload = hidden region only

Line-scoped detection is intentional — Trojan Source attacks typically
rely on visual deception within a single line of code or prompt content.

## Parameters

### text

`string`

### options?

[`ScanOptions`](../interfaces/ScanOptions.md) = `{}`

### context?

[`ScanContext`](../interfaces/ScanContext.md) = `{}`

## Returns

[`ThreatReport`](../interfaces/ThreatReport.md)[]

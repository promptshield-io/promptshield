---
title: CLI Commands
description: Detailed reference for PromptShield CLI commands.
---

# CLI Commands

The `@promptshield/cli` package provides a suite of commands to run the scanning engine across your workspace, fix issues automatically, and enforce deterministic sanitization.

All commands support resolving configuration from a `promptshield.config.json` file in your workspace root.

---

## üîç `scan`

The primary command for detecting threats in your codebase.

**Usage:**

```bash
promptshield scan [patterns...]
```

By default, without patterns, it scans `**/*`.

**Options:**

| Flag | Type | Description |
| :--- | :--- | :--- |
| `-c, --config <path>` | string | Path to a custom configuration file. |
| `--min-severity <level>` | `LOW` \| `MEDIUM` \| `HIGH` \| `CRITICAL` | Only report threats at or above this severity. |
| `--no-inline-ignore` | boolean | Ignore `promptshield-ignore` directives in source files. |
| `--concurrency <num>` | number | Number of files to process simultaneously. |
| `--cache <mode>` | `auto` \| `single` \| `split` \| `none` | Control the caching strategy. Default is `auto`. |
| `--force` | boolean | Ignore cache and force a full workspace rescan. |
| `--json` | boolean | Output results as a machine-readable JSON array. |

**Exit Codes:**

- `0`: Scan completed, no threats found above the `min-severity` threshold.
- `1`: Scan completed, threats were found. This intentionally breaks CI/CD pipelines.

---

## üõ† `fix`

The `fix` command runs the scanner and attempts to automatically resolve non-destructive issues (like removing invisible characters or un-smuggling Base64 payloads) using the deterministic rules in `@promptshield/sanitizer`.

**Usage:**

```bash
promptshield fix [patterns...]
```

**Options:**

Supports all the options of the `scan` command, plus:

| Flag | Type | Description |
| :--- | :--- | :--- |
| `-w, --write` | boolean | Persist the fixed files back to disk. If omitted, `fix` runs in a "dry-run" mode. |

**Exit Codes:**

- `0`: Completed successfully. If `--write` is specified, files were modified.
- `1`: Scan found threats that could *not* be automatically fixed.

---

## üöø `sanitize`

The `sanitize` command is a lower-level utility that runs the *entire* sanitization pipeline over the matched files, ignoring the detection engine entirely.

It is idempotent and guarantees a clean state, regardless of whether a specific threat was detected.

**Usage:**

```bash
promptshield sanitize [patterns...]
```

**Options:**

| Flag | Type | Description |
| :--- | :--- | :--- |
| `-w, --write` | boolean | Persist the sanitized files back to disk. If omitted, `sanitize` runs in a "dry-run" mode. |
| `--strict` | boolean | Apply NFKC Unicode normalization. **Warning:** This can be destructive to intentional typography or mathematical symbols. |
| `--concurrency <num>` | number | Number of files to process simultaneously. |

**Exit Codes:**

- `0`: Completed successfully.

---

## Example Workflows

**CI/CD Pipeline (Fail on HIGH/CRITICAL):**

```bash
promptshield scan --min-severity HIGH
```

**Pre-commit Hook Setup (Fix automatically):**

```bash
promptshield fix "**/*.ts" "**/*.md" --write
```

**Aggressive Content Cleanup:**

```bash
promptshield sanitize content/**/*.md --write --strict
```
